---
description: Insecure Direct Object Reference
---

# IDOR

[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References)

[https://pentestbook.six2dez.com/enumeration/web/idor](https://pentestbook.six2dez.com/enumeration/web/idor)

## Overview

IDOR stands for Insecure Direct Object Reference and is a type of access control vulnerability.

This type of vulnerability can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), too much trust has been placed on the input data, and it is not validated on the server-side to confirm the requested object belongs to the user requesting it.

## Use cases

Changing user\_id to see other accounts/profiles. Find IDOR in Hashed IDs. If unpredictable IDs, create two accounts, switch the IDs and if we can see the other user's content, we find a valid IDOR vulnerability.

For example, let's say we're logging into our bank account, and after correctly authenticating ourselves, we get taken to a URL like this [https://example.com/bank?account\_number=1234](https://example.com/bank?account_number=1234). On that page we can see all our important bank details, and a user would do whatever they needed to do and move along their way thinking nothing is wrong.

There is however a potentially huge problem here, a hacker may be able to change the account\_number parameter to something else like 1235, and if the site is incorrectly configured, then he would have access to someone else's bank information.

## Identification

IDORs might be located on the address bar, other request parameters, content your browser loads in via an AJAX request or something that you find referenced in a JavaScript file. Also parameter mining in case a path can be brute forced or found a new parameter that is available.

## Exploitation

We start off with an example page.



![](https://imgur.com/q2kqkfT.png)

It makes enough sense, if you authenticate with the right user, you get to access that user's note.

![](https://imgur.com/peFWimx.png)

If you have the wrong password, you get an incorrect password message. For our purposes the user is noot, and the password is test1234. Authenticating correctly, as expected takes us to our note.

![](https://imgur.com/2jSUDQ6.png)

However, as you may have picked up on, there seems to be an interesting part of the URL. It seems that the note that we can view is controlled by a URL parameter, let's check if we can access other notes, by increasing the number to 2.



![](https://imgur.com/hayJHKV.png)

Woohoo! We can access other's notes. While this may seem dramatic, exploiting this is the real world can have drastic consequences. Let's say you found an IDOR vulnerability in a note keeping site, which allowed you to access the notes of others, you could find plenty of personal details, like passwords, usernames, even credit card information.

There is no way to automatically exploit this, as the pentester you need to examine the site, and find misconfigurations.

## Tools

Param Miner Burp extension [https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943)

[https://dalfox.hahwul.com/docs/parameter-mining/](https://dalfox.hahwul.com/docs/parameter-mining/)
