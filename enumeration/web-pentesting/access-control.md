# Access Control

Access control is who or what is authorized to perform actions or access resources.

* **Authentication** confirms that the user is who they say they are.
* **Session management** identifies which subsequent HTTP requests are being made by that same user.
* **Access control** determines whether the user is allowed to carry out the action that they are attempting to perform.

## Vertical privilege escalation

{% code overflow="wrap" fullWidth="true" %}
```sh
Example: non-administrative user can gain access to an admin page where they can delete user accounts.

################ Unprotected functionality
# This pages could be found by trial and error, bruteforcing, source code...
https://insecure-website.com/admin
https://insecure-website.com/robots.txt
# In some cases, sensitive stuff is given a less predictable URL ("security by obscurity")
https://insecure-website.com/administrator-panel-yb556
# This might not be directly guessable by an attacker but could be leak on source code (Javascript for example):
<script>
	var isAdmin = false;
	if (isAdmin) {
		...
		var adminPanelTag = document.createElement('a');
		adminPanelTag.setAttribute('href', 'https://insecure-website.com/administrator-panel-yb556');
		adminPanelTag.innerText = 'Admin panel';
		...
	}
</script>

################ Parameter-based access control methods
Some apps determine the user access rights or role at login -> store this info in a user-controllable location:
    A hidden field.
    A cookie.
    A preset query string parameter.
# The app makes access control decisions based on the submitted value. For example: 
https://insecure-website.com/login/home.jsp?admin=true
https://insecure-website.com/login/home.jsp?role=1
# EXAMPLE: cookie called "admin"
```
{% endcode %}

## Horizontal privilege escalation

{% code overflow="wrap" fullWidth="true" %}
```sh
# For example, if an employee can access the records of other employees as well as their own.
https://insecure-website.com/myaccount?id=123
# NOTE: This is an example of an insecure direct object reference (IDOR) vulnerability.
On some apps, the exploitable param is not predictable (GUIDs), but they could be disclosed elsewhere on the app
where users are referenced, such as user messages or reviews.
```
{% endcode %}

## Horizontal to vertical privilege escalation

{% code overflow="wrap" fullWidth="true" %}
```sh
# For example, a horizontal escalation might allow an attacker to reset or capture the password belonging 
# to another user. If the attacker targets an administrative user and compromises their account...
https://insecure-website.com/myaccount?id=456
# Getting admin panel access -> might disclose the admin pwd, a way of changing it or privilged functionality. 
/my-account?id=administrator
```
{% endcode %}
