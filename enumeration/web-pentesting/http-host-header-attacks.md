# HTTP Host Header Attacks

The HTTP Host header is a mandatory request header as of HTTP/1.1. It specifies the domain name that the client wants to access. For example, when a user visits `https://portswigger.net/web-security`, their browser will compose a request containing a Host header as follows:

```
GET /web-security HTTP/1.1
Host: portswigger.net
```

## How do HTTP Host header vulnerabilities arise?

Due to the flawed assumption that the header is not user controllable.

{% code overflow="wrap" fullWidth="true" %}
```sh
Supply an arbitrary Host header
Burp separates Host header and target IP address so that helps to change Host header and still reach dest IP. (Target, pencil to edit)

######## Check for flawed validation
# Try to set a payload instead of :(numeric-port)
GET /example HTTP/1.1
Host: vulnerable-website.com:bad-stuff-here
# registering an arbitrary domain name that ends with the same sequence of characters as a whitelisted one: 
GET /example HTTP/1.1
Host: notvulnerable-website.com
# take advantage of a less-secure subdomain that you have already compromised: 
GET /example HTTP/1.1
Host: hacked-subdomain.vulnerable-website.com

######### Send ambiguous requests
# Inject duplicate Host headers
GET /example HTTP/1.1
Host: vulnerable-website.com
Host: bad-stuff-here
# Supply an absolute URL
GET https://vulnerable-website.com/ HTTP/1.1
Host: bad-stuff-here
# Add line wrapping
GET /example HTTP/1.1
    Host: bad-stuff-here
Host: vulnerable-website.com

########### Inject host override headers
GET /example HTTP/1.1
Host: vulnerable-website.com
X-Forwarded-Host: bad-stuff-here
#Although X-Forwarded-Host is the de facto standard for this behavior, you may come across other headers that serve a similar purpose, including:
    X-Host
    X-Forwarded-Server
    X-HTTP-Host-Override
    Forwarded
# NOTE: Param Miner extension's "Guess headers" function to automatically probe for supported headers
```
{% endcode %}

## How to exploit the HTTP Host header



## How to prevent HTTP Host header attacks

Avoid using the Host header altogether in server-side code.

Double-check whether each URL really needs to be absolute, Protect absolute URLs

Validate the Host header

Don't support Host override headers, in particular `X-Forwarded-Host`

Whitelist permitted domains

Be careful with internal-only virtual hosts, do not host them on same public-facing server
