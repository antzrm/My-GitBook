# Others

## Forced Browsing

{% tabs %}
{% tab title="Overview" %}
Forced browsing is the art of using logic to find resources on the website that you would not normally be able to access. For example let's say we have a note taking site, that is structured like this. [http://example.com/user1/note.txt](http://example.com/user1/note.txt). It stands to reason that if we did [http://example.com/user2/note.txt](http://example.com/user2/note.txt) we may be able to access user2's note.&#x20;

Taking this a step further, if we ran wfuzz on that url, we could enumerate users we don't know about, as well as get their notes. This is quite devastating, because we can then run further attacks on the users we find, for example bruteforcing each user we find, to see if they have weak passwords.
{% endtab %}

{% tab title="Manual exploitation" %}
We start off with our basic note taking application.



![](https://imgur.com/zQPqKS8.png)

For our purposes the user and password are noot, and test1234. Properly authenticating shows us our note.



![](https://imgur.com/tSSJdfi.png)

Let's look over what we have. The user we authenticated as is noot, and the path for the note is noot/note.txt. Therefore, it seems notes are stored in \<username>/note.txt, meaning that if we find other usernames, we may be able to read other's notes! Often times on any application there is an admin user, so let's see if we can view his note.



![](https://imgur.com/COgxTaK.png)

Woohoo!

Forced browsing will often require some logic on the part of the hacker. To properly exploit this, you should keep notes on everything you find, building a picture of how the web application functions is essential.
{% endtab %}

{% tab title="Automatic exploitation" %}
Than sort of be exploited automatically. A tool such as wfuzz or dirsearch can find resources that normal users wouldn't be able to find. wfuzz will be the better tool in most cases, as it allows you better control over the path, so we'll go over basic wfuzz usage, and use it to exploit the our example site. wfuzz can be installed using `pip3 install wfuzz`.

wfuzz flags:\


| <p>-c<br></p>   | <p>Shows the output in color<br></p>                                                                                                                     |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p>-z<br></p>   | <p>Specifies what will replace FUZZ in the request. For example -z file,big.txt will read through all the lines of big.txt and replace FUZZ with<br></p> |
| <p>--hc<br></p> | <p>Don't show certain http response codes<br></p>                                                                                                        |
| <p>--hl<br></p> | <p>Don't show a certain amount of lines in the response<br></p>                                                                                          |
| <p>--hh<br></p> | <p>Don't show a certain amount of words<br></p>                                                                                                          |

Let's make a request



![](https://imgur.com/K5ykhIx.png)

We can see that when there isn't a note.txt it returns a 404, with 57 words. Let's hide 57 words by setting --hw to 57.



![](https://imgur.com/eYRJeyt.png)

Boom, we found the admin note!
{% endtab %}
{% endtabs %}

## Mass Assignment

* We can add additional parameters we know they exist [https://cheatsheetseries.owasp.org/cheatsheets/Mass\_Assignment\_Cheat\_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html)
* POST or PATCH HTTP verb request
* Review Javascript source code to find hidden parameters
* insert random parameter `&x=y` to observe error message leaking information of positive result

```
username=administrator%26x=y
```

## Web Sockets

{% code overflow="wrap" fullWidth="true" %}
```
https://exploit-notes.hdks.org/exploit/web/websocket-pentesting/#cross-site-websocket-hijacking
# Blind SQLi
12 or substring(version(),1,1)=8
# and check WebSockets history on Burp. Note there the URL and modify target , adapt the script by intercepting Burp Websocket request (modify ws://$IP/$PATH and the parameter which might not be id); then
sqlmap -u ... --dbs # do not use batch, try to reduce the requests manually or the service might crash
# Alternative: 
sqlmap -u "ws://..." --data "{'id':...}" --level 5 --risk 3 --batch --threads 10 # Threads are safe to do in a boolean injection, not for time-based injections
```
{% endcode %}

## SQL Truncation

{% embed url="https://medium.com/r3d-buck3t/bypass-authentication-with-sql-truncation-attack-25a0c33ab87f" %}

## Open Redirect

[https://book.hacktricks.xyz/pentesting-web/open-redirect](https://book.hacktricks.xyz/pentesting-web/open-redirect)

## LDAP Injection&#x20;

[https://book.hacktricks.xyz/pentesting-web/ldap-injection](https://book.hacktricks.xyz/pentesting-web/ldap-injection)

## Prototype Pollution in Javascript&#x20;

[https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution](https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution)

## Clickjacking&#x20;

Burp ClickBandit

## LaTEX Injection

[https://book.hacktricks.xyz/pentesting-web/formula-csv-doc-latex-ghostscript-injection#latex-injection](https://book.hacktricks.xyz/pentesting-web/formula-csv-doc-latex-ghostscript-injection#latex-injection)

## Software Integrity

[https://www.srihash.org/](https://www.srihash.org/)

The correct way to insert the library in your HTML code would be to use SRI and include an integrity hash so that if somehow an attacker is able to modify the library, any client navigating through your website won't execute the modified version. Here's how that should look in HTML:

`<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>`

