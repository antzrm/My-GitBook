# Information Disclosure

## 404 Web Pages

{% embed url="https://0xdf.gitlab.io/cheatsheets/404" %}

## What is information disclosure?

Information disclosure, also known as information leakage, is when a website unintentionally reveals sensitive information to its users.

* Data about other users, such as usernames or financial information
* Sensitive commercial or business data
* Technical details about the website and its infrastructure

#### **Examples of information disclosure**

* Revealing the names of hidden directories, their structure, and their contents via a `robots.txt` file or directory listing
* Providing access to source code files via temporary backups
* Explicitly mentioning database table or column names in error messages
* Unnecessarily exposing highly sensitive information, such as credit card details
* Hard-coding API keys, IP addresses, database credentials, and so on in the source code
* Hinting at the existence or absence of resources, usernames, and so on via subtle differences in application behavior

## How do information disclosure vulnerabilities arise?

* **Failure to remove internal content from public content** (comments)
* **Insecure configuration of the website and related technologies** (debug mode, verbose)
* **Flawed design and behavior of the application** (different responses w/ different errors)

## What is the impact of information disclosure vulnerabilities?

In some cases, just disclosing sensitive information alone can have a high impact on the affected parties. For example, an online shop leaking its customers' credit card details.

On the other hand, leaking technical information may have little to no direct impact. However, in the wrong hands, this could be the key information required to construct any number of other exploits. The severity in this case depends on what the attacker is able to do with this information.

#### **How to assess the severity of information disclosure vulnerabilities**

Disclosure of technical information in particular is often only of interest if you are able to demonstrate how an attacker could do something harmful with it. This depends on if versions are fully patched or are old and contain know vulnerabilities.

Main focus -> impact and exploitability of the leaked information, not just the presence of information disclosure per se.

Obvious exception -> leaked information is so sensitive that it warrants attention in its own right.

## How to test for information disclosure vulnerabilities

{% code overflow="wrap" fullWidth="true" %}
```sh
It is important not to develop "tunnel vision" during testing (often find sensitive data while testing for sth else).

##################################### FUZZING
If you identify interesting params -> submit unexpected data types and specially crafted fuzz strings to see the effect
Responses can disclose stuff subtly -> time response different, one error case instead of another one...
#  You can automate much of this process using tools such as Burp Intruder:
- Add payload positions to params and use pre-built wordlists of fuzz strings to test a high volume of different inputs in quick succession
- Easily identify differences in responses by comparing HTTP status codes, response times, lengths, and so on.
- Use grep matching rules to quickly identify occurrences of keywords, such as error, invalid, SELECT, SQL, and so on.
- Apply grep extraction rules to extract and compare the content of interesting items within responses.
You can also use the Logger++ extension -> define advanced filters for highlighting interesting entries.

##################################### BURP SCANNER
On Burp Pro / live scanning and scheduled / alert you if sensitive files/info, backups, directory listing ...

##################################### BURP ENGAGEMENT TOOLS
# Search
Look for any expression/keyword within the selected item (also advanced options such as regex, negative search...)
# Find comments
Quickly extract any developer comments found in the selected items. Also provides HTTP request/response of the comment.
# Discover content
Identify additional content and functionality that is not linked from the website visible content / sitemap.

#################################### ENGINEERING INFORMATIVE RESPONSES
Verbose error messages can sometimes disclose interesting information.
In some cases, you will be able to manipulate the website in order to extract arbitrary data via an error message.
Example: make the app logic attempt an invalid action on a specific item of data -> submit invalid parameter value
```
{% endcode %}

## Common sources of information disclosure

{% code overflow="wrap" fullWidth="true" %}
```sh
##################################### Files for web crawlers
/robots.txt and /sitemap.xml -> files provided to help crawlers navigate their site, some to skip also, worth to try

##################################### Directory listings
Web servers can be configured to automatically list the contents of directories that do not have an index page present.
Might not be a vuln if proper access control. If not, leaking existence and location of sensitive resources is an issue.

##################################### Developer comments
Comments can sometimes be forgotten, missed, or even left in deliberately -> could contain useful info for an attacker

##################################### Error messages
The content of error messages can reveal information about what input or data type is expected from a given parameter. 
Verbose error messages can also provide information about different technologies being used by the website. 
You might also discover that the website is using some kind of open-source framework -> study the public code for vulns
Differences between error messages can also reveal different app behavior -> useful for SQLi, user enum...
# EXAMPLE: Information disclosure in error messages
- Fuzz any param with quotes, invalid values and so on to disclose software version via error message

##################################### Debugging data
For debugging purposes, many webs generate custom error messages and logs that contain lots of info about app behaviour.
# Debug messages can sometimes contain vital information for developing an attack, including:
    Values for key session variables that can be manipulated via user input
    Hostnames and credentials for back-end components
    File and directory names on the server
    Keys used to encrypt data transmitted via the client
Debugging info may sometimes be logged in a separate file -> try to gain access to this file
# EXAMPLE: Information disclosure on debug page
- Browse the website, read source code.
- Find comment with debug path that discloses PHP info file.
- Look for SECRET_KEY and other sensitive data there.

################################### User account pages
#  For example, consider a website that determines which user's account page to load based on a user parameter.
GET /user/personal-info?user=carlos
# Changing user parameter might be enough to access other users' data -> IDOR / access control topic

################################### Source code disclosure via backup files
Source code -> easier to understand the app behaviour -> maybe hard-coded sensitive data (API keys, creds...)
Occasionally, it is even possible to cause the website to expose its own source code. You might find some backup files
are referenced but you cannot see all and is only executed (.php). However, in some situations, you can trick a web
to return content file instead.
Text editors often generate temporary backup files by appending a tilde (~) to filename or adding a different file ext
# EXAMPLE: Source code disclosure via backup files
- Visit robots.txt or sitemap.xml
- Find hidden directory.
- Visit hidden directory to find a Java backup file and read sensitive data there.

################################### Information disclosure due to insecure configuration
Improper config -> 3rd party apps, lots of config options not well-understood by those implementing them. 
Devs might forget to disable various debugging options -> HTTP TRACE method is designed for diagnostic purposes
# EXAMPLE: Authentication bypass via information disclosure
- Log in, then fuzz or guess  /admin path but only available to local users
- Try HTTP TRACE method on several requests -> find hidden headers that are related to authorization
- Use that header to access /admin panel as localhost -> X-Custom-Ip-Authorization: 127.0.0.1

#################################### Version control history
Version control system (Git) -> .git, look for /.git path
If we download and install locally the repo, we might find logs containing committed changes and other interesting information. 
```
{% endcode %}

## How to prevent information disclosure vulnerabilities

* Make sure that everyone involved in producing the website is fully aware of what information is considered sensitive.
* Audit any code for potential information disclosure as part of your QA or build processes.
* Use generic error messages as much as possible. Don't provide attackers with clues.
* Double-check that any debugging or diagnostic features are disabled in production.
* Make sure you fully understand the configuration settings, and security implications, of any third-party technology that you implement.
